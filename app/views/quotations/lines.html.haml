-# Фильтры:

-# Код запроса: params.quotation_id
-# Наименование: строка, params.item_name
-# Производитель: params.brend_alias

-# Если указан quotation_id (вариант: если у всех строк один quotation_id, если не сложно),
-# выводим над таблицей строк запроса блок информации о данном запросе:

-# Примечание: comment
-# Статус: quotation_status

.nav-title
 %span= link_to "Запросы", quotations_path
 %span >
 %span.current Строки запросов

.content-wrap
 .filter-block
  = form_for :filter, :url => lines_quotations_path, :html => {:method => :get} do |f|
   .filter
    %table
     %tr
      %th= f.label :item_name, t(:item_name) + ':'
      %td.long{:colspan => 3}= f.text_field :item_name
     %tr
      %th= f.label :quotation_id, t(:quotation_id) + ':'
      %td.medium= f.text_field :quotation_id
     %tr
      %th= f.label :brend_alias, t(:brend_alias) + ':'
      %td.medium= f.text_field :brend_alias
     %tr
      %td= render :partial => "shared/submit_button", :locals => {:title => "Найти!"}
   -# .fields
    .field.urm
     = f.label :quotation_id, t(:quotation_id)
     = f.text_field :quotation_id
    = render :partial => "shared/submit_button", :locals => {:title => "Найти!"}
   -# .clear.block-padded
   -# .fields
    .field.urm
     = f.label :item_name, t(:item_name)
     = f.text_field :item_name
   -# .clear.block-padded
   -# .fields
    .field.urm
     = f.label :brend_alias, t(:brend_alias)
     = f.text_field :brend_alias
   .clear
   .block-padded

.clear
.content-wrap
 .table-navigation-block{:class => "scroll"}
  .table-block
   .table-scrolling
    %table.table-style{:class => "order-list"}
     %tr
      %th Код запроса
      %th Статус
      %th ROHS
      %th= t(:item_name)
      %th Производитель
      %th Цена клиента
      %th Цена предложения
      %th Текущее количество
      %th Прогноз
      %th Примечание
      %th Сумма
      %th Код номенклатуры

     = render :partial => "quotations/item_line", :collection => @lines
    .padded
    %div{:style => "display:inline-block; float:right;"}
     - unless @lines.empty?
      = form_for :export_fields, :url => export_lines_quotations_path(:format => :xls), :method => :post, :html=>{:class => "js", :style => "display: inline-block;"} do |f|
       -# %input.copiable{:type => :hidden, :value => 'input#filter_date_from'}
       -# %input.copiable{:type => :hidden, :value => 'input#filter_date_to'}
       = render :partial => "shared/submit_button", :locals => {:title => t(:export_xls), :name => "items[export]", :opts => {:class => "preload", :style => "float: right;"}}
      = form_for :export_fields, :url => export_lines_quotations_path(:format => :csv), :method => :post, :html=>{:class => "js", :style => "display: inline-block;"} do |f|
       -# %input.copiable{:type => :hidden, :value => 'input#filter_date_from'}
       -# %input.copiable{:type => :hidden, :value => 'input#filter_date_to'}
       = render :partial => "shared/submit_button", :locals => {:title => t(:export_csv), :name => "items[export]", :opts => {:class => "preload", :style => "float: right;"}}
    %div{:style => "display:inline-block; float:left;"}
     = paginate(:page => @lines.page.to_i, :pages => @lines.pages.to_i, :derid => {:align => "left", :hide_empty => true})
    %div{:style => "display:inline-block; float:left;"}
     = render :partial => "shared/stat.html.haml", :locals => {:mode => :strings, :value => @lines.records.to_i}
