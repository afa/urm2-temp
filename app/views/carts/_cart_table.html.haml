#cart_store
 %h3= t(:selected_positions)
 = form_for :cart_item, :html => {:class => 'js', :method => :put}, :url => save_carts_path, :remote => true do |ff|

  %table.table-style
   %tr
    %th
    %th= t :type
    %th= t :name
    %th= t :brend
    %th= t :rohs
    %th= t :price
    %th= t :amount
    %th= t :location
    %th= t :prognosis
    %th= t :comment
    %th= t :requirement
    %th= t :user_price
    %th= t :application_mandatory
    %th{:colspan => 3}= t :action
    -# %th
   = render :partial => "carts/cart_collection.html.haml", :locals => {:app_list => app_list, :stores => @stores, :cart => cart}
  .padded
 .block-padded
  %p Итого по заказу #{@usd_decor.decore cart.map{|i| i.current_price * i.amount }.inject(0.0){|r, i| r + i }} USD, в том числе по ДМС #{@usd_decor.decore cart.select{|i| i.is_a? CartWorld }.map{|i| i.current_price * i.amount }.inject(0.0){|r, i| r + i } } USD.
  %p Итого товара к резервированию на сумму #{@usd_decor.decore cart.select{|i| i.action == "reserve" }.map{|i| i.current_price * i.amount }.inject(0.0){|r, i| r + i } } USD (доступная сумма резерва #{@usd_decor.decore Axapta.info_cust_limits.reserve.reserve_available} USD)
  %p Суммарный вес #{cart.select{|i| i.is_a? CartStore }.map{|i| Axapta.item_info(:item_id => i.product_link)["weight"] || 0.0 }.inject(0.0){|r, i| r + i}/1000.0} кг (без учёта ряда позиций)
 .clear.block-padded
